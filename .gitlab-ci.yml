image: "alpine:latest"

before_script:
  - apk add --no-cache python3 gcc python3-dev musl-dev linux-headers libffi-dev make alpine-sdk openssl-dev
  - python3 -m venv env
  - source ./env/bin/activate
  - pip3 install -r requirements.txt

stages:
  - Static Analysis
  - Unit Tests

pylint:
  stage: Static Analysis
  allow_failure: true
  script:
  - pip3 install pylint
  - pylint ./*.py
  - pylint ./api/*.py
  - pylint ./device_lib/*.py

flake8:
  stage: Static Analysis
  allow_failure: true
  script:
  - pip3 install flake8
  - flake8 ./*
  - flake8  ./api/*.py
  - flake8  ./device_lib/*.py

Build:
  stage: Unit Tests
  script:
    - source ./env/bin/activate
#    - python3 ./web_app.py
